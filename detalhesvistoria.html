<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vistoria - Vistoria Cautelar SP</title>
    <link rel="stylesheet" href="assets/css/detalhesvistoria.css">
 
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="breadcrumb">
                <a href="#dashboard">Dashboard</a>
                <span>></span>
                <a href="#vistoria.html">Vistorias</a>
                <span>></span>
                <span id="currentProtocol">VC2024001</span>
            </div>
            
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="toggleTheme()">
                    <span id="theme-icon">üåô</span>
                </button>
                
                <a href="dashboard.html" class="btn btn-secondary">
                    <span>üìã</span>
                    Voltar
                </a>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="vistoria-details">
            <div class="details-header">
                <div class="protocol-title">
                    <span class="protocol-number" id="protocolNumber">VC2024001</span>
                    <span class="status-badge status-pendente" id="statusBadge">Pendente</span>
                </div>
                <div class="client-info" id="clientInfo">
                    Jo√£o Silva Santos - Rua das Flores, 123 - Centro
                </div>
            </div>

            <div class="details-content">
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Vistoriador Respons√°vel</span>
                        <span class="info-value" id="vistoriadorName">Maria Santos</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Data da Vistoria</span>
                        <span class="info-value" id="vistoriaDate">15/01/2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Data de Vencimento</span>
                        <span class="info-value" id="vencimentoDate">20/01/2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Prioridade</span>
                        <span class="priority-badge priority-alta" id="priorityBadge">Alta</span>
                    </div>
                </div>

                <div id="alertContainer"></div>

                <div id="resultSection">
                    <div class="result-form">
                        <h3 class="section-title">
                            <span>üìã</span>
                            Registrar Resultado
                        </h3>
                        <form id="resultForm">
                            <div class="form-group">
                                <label for="resultStatus" class="form-label">Status</label>
                                <select id="resultStatus" class="form-select" required>
                                    <option value="">Selecione o status</option>
                                    <option value="pendente">Pendente</option>
                                    <option value="andamento">Em Andamento</option>
                                    <option value="concluida">Conclu√≠da</option>
                                    <option value="cancelada">Cancelada</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="resultComment" class="form-label">Coment√°rio</label>
                                <textarea id="resultComment" class="form-textarea" placeholder="Digite suas observa√ß√µes sobre o resultado" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Salvar Resultado</button>
                        </form>
                    </div>
                </div>

                <div class="observations-section">
                    <h3 class="section-title">
                        <span>üìù</span>
                        Hist√≥rico de Observa√ß√µes
                    </h3>
                    <div id="observationsList">
                        <!-- Observa√ß√µes carregadas dinamicamente pelo JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="sidebar-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span>‚ö°</span>
                        A√ß√µes R√°pidas
                    </h3>
                </div>
                <div class="card-content" id="quickActions">
                    <button class="action-button btn-primary" onclick="alert('Iniciando vistoria...')">
                        <span>‚ñ∂Ô∏è</span>
                        Iniciar Vistoria
                    </button>
                    <button class="action-button btn-success" onclick="alert('Finalizando vistoria...')">
                        <span>‚úÖ</span>
                        Finalizar Vistoria
                    </button>
                    <button class="action-button btn-warning" onclick="alert('Cancelando vistoria...')">
                        <span>‚ùå</span>
                        Cancelar Vistoria
                    </button>
                </div>
            </div>

            <div class="sidebar-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span>üìÖ</span>
                        Linha do Tempo
                    </h3>
                </div>
                <div class="card-content">
                    <div class="timeline" id="vistoriaTimeline">
                        <!-- Linha do tempo carregada dinamicamente pelo JavaScript -->
                    </div>
                </div>
            </div>

            <div class="sidebar-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span>üìä</span>
                        Estat√≠sticas
                    </h3>
                </div>
                <div class="card-content">
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Tempo Decorrido</span>
                            <span class="info-value" id="tempoDecorrido">3 dias</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Fun√ß√£o para alternar tema claro/escuro
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.textContent = 'üåô';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Verifica o tema salvo no localStorage ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                document.getElementById('theme-icon').textContent = '‚òÄÔ∏è';
            }

            // Dados fict√≠cios para observa√ß√µes
            const observations = [
                {
                    author: "Maria Santos",
                    date: "14/01/2024 14:30",
                    text: "Realizada vistoria inicial. Ve√≠culo em bom estado, aguardando an√°lise detalhada."
                },
                {
                    author: "Jo√£o Silva",
                    date: "15/01/2024 09:15",
                    text: "Pend√™ncia identificada na documenta√ß√£o. Solicitado ajuste."
                }
            ];

            // Carrega observa√ß√µes dinamicamente
            const observationsList = document.getElementById('observationsList');
            observations.forEach(obs => {
                const observationItem = document.createElement('div');
                observationItem.className = 'observation-item';
                observationItem.innerHTML = `
                    <div class="observation-header">
                        <span class="observation-author">${obs.author}</span>
                        <span class="observation-date">${obs.date}</span>
                    </div>
                    <p class="observation-text">${obs.text}</p>
                `;
                observationsList.appendChild(observationItem);
            });

            // Dados fict√≠cios para linha do tempo
            const timelineEvents = [
                {
                    date: "14/01/2024 14:30",
                    title: "Vistoria Iniciada",
                    description: "Vistoria iniciada pelo respons√°vel Maria Santos."
                },
                {
                    date: "15/01/2024 09:15",
                    title: "Pend√™ncia Identificada",
                    description: "Pend√™ncia na documenta√ß√£o reportada por Jo√£o Silva."
                }
            ];

            // Carrega linha do tempo dinamicamente
            const timeline = document.getElementById('vistoriaTimeline');
            timelineEvents.forEach(event => {
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.innerHTML = `
                    <div class="timeline-date">${event.date}</div>
                    <div class="timeline-title">${event.title}</div>
                    <div class="timeline-description">${event.description}</div>
                `;
                timeline.appendChild(timelineItem);
            });

            // Manipula√ß√£o do formul√°rio de resultado
            const resultForm = document.getElementById('resultForm');
            const alertContainer = document.getElementById('alertContainer');
            const statusBadge = document.getElementById('statusBadge');

            resultForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const status = document.getElementById('resultStatus').value;
                const comment = document.getElementById('resultComment').value;

                if (status && comment) {
                    // Atualiza o status da vistoria
                    statusBadge.textContent = status.charAt(0).toUpperCase() + status.slice(1);
                    statusBadge.className = `status-badge status-${status}`;

                    // Exibe alerta de sucesso
                    alertContainer.innerHTML = `
                        <div class="alert alert-success">
                            Resultado salvo com sucesso!
                        </div>
                    `;

                    // Adiciona nova observa√ß√£o
                    const newObservation = {
                        author: "Sistema",
                        date: new Date().toLocaleString('pt-BR'),
                        text: comment
                    };
                    const observationItem = document.createElement('div');
                    observationItem.className = 'observation-item';
                    observationItem.innerHTML = `
                        <div class="observation-header">
                            <span class="observation-author">${newObservation.author}</span>
                            <span class="observation-date">${newObservation.date}</span>
                        </div>
                        <p class="observation-text">${newObservation.text}</p>
                    `;
                    observationsList.prepend(observationItem);

                    // Adiciona evento √† linha do tempo
                    const newTimelineItem = document.createElement('div');
                    newTimelineItem.className = 'timeline-item';
                    newTimelineItem.innerHTML = `
                        <div class="timeline-date">${newObservation.date}</div>
                        <div class="timeline-title">Status Atualizado</div>
                        <div class="timeline-description">Status alterado para "${status}" com coment√°rio: ${comment}</div>
                    `;
                    timeline.prepend(newTimelineItem);

                    // Limpa o formul√°rio
                    resultForm.reset();
                } else {
                    // Exibe alerta de erro
                    alertContainer.innerHTML = `
                        <div class="alert alert-error">
                            Por favor, preencha todos os campos!
                        </div>
                    `;
                }
            });
        });
    </script>
</body>
</html>